<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Coral Observations Map</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { margin: 0; font-family: Montserrat, sans-serif; }
    #map { height: 100vh; width: 100%; }
  </style>
</head>
<body>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  const map = L.map('map').setView([-33.85, 151.2], 10);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  fetch("https://opensheet.elk.sh/1q_lPdKDKKcEWWc6SNfWOoNa34Ra9W5SX6VrEvCgWWZ4/Sheet1")
    .then(res => res.json())
    .then(data => {
      data.forEach(row => {
        const lat = parseFloat(row.Latitude);
        const lng = parseFloat(row.Longitude);
        if (!isNaN(lat) && !isNaN(lng)) {
          const color = row["Coral observed"] === "Y" ? "green" : "red";
          const marker = L.circleMarker([lat, lng], {
            radius: 8,
            color: color,
            fillColor: color,
            fillOpacity: 0.8
          }).addTo(map);

          const popup = `
            <strong>Observer:</strong> ${row.Observer}<br/>
            <strong>Area:</strong> ${row.Area}<br/>
            <strong>Coral observed:</strong> ${row["Coral observed"]}<br/>
            ${row.Species ? `<strong>Species:</strong> ${row.Species}<br/>` : ""}
            ${row.Notes ? `<strong>Notes:</strong> ${row.Notes}<br/>` : ""}
            ${row["Photo URL"] ? `<img src="${row["Photo URL"]}" width="100"/>` : ""}
          `;
          marker.bindPopup(popup);
        }
      });
    });
</script>

</body>
</html>
